{"objects":[{"jobObject":{"JobType":".TransformationJob","id":601,"revision":2,"created":1639565394099,"timestamp":1639565394099,"components":{"604":{"id":604,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":304,"y":304,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[620],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_xrate"}}}},"visible":true},"2":{"slot":2,"name":"Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_xrate"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Timestamp"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"EUR"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_database}"}}}},"visible":true},"6":{"slot":6,"name":"Offset Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"8":{"slot":8,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"activationStatus":"ENABLED"},"605":{"id":605,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":742,"y":309,"width":32,"height":32,"inputConnectorIDs":[616,617,618],"outputConnectorIDs":[623],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Find missing dates"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Spine"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MinMax"},"2":{"slot":2,"type":"STRING","value":"mm"},"3":{"slot":3,"type":"STRING","value":"Inner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"String to Date"},"2":{"slot":2,"type":"STRING","value":"o"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_ADD(`mm`.`min_datevalue`, `s`.`sequence`) <= `mm`.`max_datevalue`"},"2":{"slot":2,"type":"STRING","value":"s_Inner_mm"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"`o`.`datevalue` = DATE_ADD(`mm`.`min_datevalue`, `s`.`sequence`)"},"2":{"slot":2,"type":"STRING","value":"s_Left_o"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s.sequence"},"2":{"slot":2,"type":"STRING","value":"sequence"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"mm.min_datevalue"},"2":{"slot":2,"type":"STRING","value":"start_date"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"o.datevalue"},"2":{"slot":2,"type":"STRING","value":"measurement_date"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"o.eur"},"2":{"slot":2,"type":"STRING","value":"EUR"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"606":{"id":606,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1439414779,"x":614,"y":213,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[617],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Spine"}}}},"visible":true},"2":{"slot":2,"name":"Starting Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"0"}}}},"visible":true},"3":{"slot":3,"name":"Increment Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"4":{"slot":4,"name":"End Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"5000"}}}},"visible":true},"5":{"slot":5,"name":"Output Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sequence"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"607":{"id":607,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":870,"y":309,"width":32,"height":32,"inputConnectorIDs":[623],"outputConnectorIDs":[626],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_ADD(`start_date`, `sequence`)"},"2":{"slot":2,"type":"STRING","value":"densified_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN `measurement_date` IS NULL THEN NULL ELSE `sequence` END"},"2":{"slot":2,"type":"STRING","value":"gapseq"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"608":{"id":608,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":486,"y":309,"width":32,"height":32,"inputConnectorIDs":[620],"outputConnectorIDs":[616,622],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"String to Date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_DATE(`timestamp`, 'yyyy-MM-dd')"},"2":{"slot":2,"type":"STRING","value":"datevalue"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"609":{"id":609,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1190,"y":229,"width":32,"height":32,"inputConnectorIDs":[624],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Last Known"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_VALUE(`eur`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"},"2":{"slot":2,"type":"STRING","value":"EUR_last_known"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"610":{"id":610,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":1030,"y":309,"width":32,"height":32,"inputConnectorIDs":[626],"outputConnectorIDs":[624,627,619,621],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Renamer"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sequence"},"2":{"slot":2,"type":"STRING","value":"sequence"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"densified_date"},"2":{"slot":2,"type":"STRING","value":"datevalue"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"gapseq"},"2":{"slot":2,"type":"STRING","value":"gapseq"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"EUR"},"2":{"slot":2,"type":"STRING","value":"EUR"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"611":{"id":611,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1190,"y":149,"width":32,"height":32,"inputConnectorIDs":[619],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Zero Filled"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NVL(`eur`, 0)"},"2":{"slot":2,"type":"STRING","value":"EUR_zero_filled"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"612":{"id":612,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":609793074,"x":1190,"y":309,"width":32,"height":32,"inputConnectorIDs":[621],"outputConnectorIDs":[625],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rolling Mean"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datevalue"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Lower Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"offset preceding"}}}},"visible":true},"6":{"slot":6,"name":"Upper Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"current row"}}}},"visible":true},"7":{"slot":7,"name":"Lower Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"3"}}}},"visible":true},"8":{"slot":8,"name":"Upper Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"3"}}}},"visible":false},"9":{"slot":9,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average"},"2":{"slot":2,"type":"STRING","value":"EUR"},"3":{"slot":3,"type":"STRING","value":"EUR_rolling_mean"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"613":{"id":613,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":1190,"y":469,"width":32,"height":32,"inputConnectorIDs":[627],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Linear Backfill"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH data AS (\nSELECT `sequence`, `datevalue`, `gapseq`, `eur`,\n       LAST_VALUE(`gapseq`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS prior_gapseq,\n       FIRST_VALUE(`gapseq`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS next_gapseq,\n       LAST_VALUE(`eur`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS prior_EUR,\n       FIRST_VALUE(`eur`, TRUE) OVER (ORDER BY `datevalue` ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS next_EUR\nFROM $T{Renamer})\nSELECT `sequence`, `datevalue`, `gapseq`, `eur`,\n       CASE WHEN `eur` IS NULL\n            THEN prior_EUR + ((next_EUR - prior_EUR) * (`sequence` - `prior_gapseq`) / (`next_gapseq` - `prior_gapseq`))\n            ELSE `eur`\n       END AS `EUR_linear_fill`\nFROM data\nORDER BY `sequence` DESC"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"614":{"id":614,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1302,"y":309,"width":32,"height":32,"inputConnectorIDs":[625],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rolling Mean coalesced"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COALESCE(`eur`, `eur_rolling_mean`)"},"2":{"slot":2,"type":"STRING","value":"EUR_rolling_mean_coalesced"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"615":{"id":615,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":608,"y":400,"width":32,"height":32,"inputConnectorIDs":[622],"outputConnectorIDs":[618],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MinMax"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datevalue"},"2":{"slot":2,"type":"STRING","value":"Min"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"datevalue"},"2":{"slot":2,"type":"STRING","value":"Max"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"}},"connectors":{"616":{"id":616,"sourceID":608,"targetID":605},"617":{"id":617,"sourceID":606,"targetID":605},"618":{"id":618,"sourceID":615,"targetID":605},"619":{"id":619,"sourceID":610,"targetID":611},"620":{"id":620,"sourceID":604,"targetID":608},"621":{"id":621,"sourceID":610,"targetID":612},"622":{"id":622,"sourceID":608,"targetID":615},"623":{"id":623,"sourceID":605,"targetID":607},"624":{"id":624,"sourceID":610,"targetID":609},"625":{"id":625,"sourceID":612,"targetID":614},"626":{"id":626,"sourceID":607,"targetID":610},"627":{"id":627,"sourceID":610,"targetID":613}},"canUndo":false,"undoCommand":"","undoCreated":-1,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"602":{"id":602,"x":320,"y":86,"width":705,"height":40,"text":"Numeric data densification examples","colour":"00ce4f"},"603":{"id":603,"x":1161,"y":368,"width":155,"height":40,"text":"Linear Regression is a workspace notebook task","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"id":601,"name":"example densification transformation","type":"TRANSFORMATION","tag":"335bc912-e4fa-4329-aa2a-b60582322ae8"},"path":["matillion-examples","densification"]}],"version":"1.56.10","environment":"deltalake"}