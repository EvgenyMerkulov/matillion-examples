{"objects":[{"jobObject":{"JobType":".TransformationJob","id":2670,"revision":7,"created":1641475591544,"timestamp":1641475591544,"components":{"2672":{"id":2672,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":192,"y":288,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2706],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_xrate2"}}}},"visible":true},"2":{"slot":2,"name":"Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_xrate2"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"timestamp"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"eur"}}}},"visible":true},"4":{"slot":4,"name":"Trim Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2673":{"id":2673,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":611,"y":288,"width":32,"height":32,"inputConnectorIDs":[2705,2708,2703],"outputConnectorIDs":[2687],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Find missing dates"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Spine"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MinMax"},"2":{"slot":2,"type":"STRING","value":"mm"},"3":{"slot":3,"type":"STRING","value":"Inner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"String to Date"},"2":{"slot":2,"type":"STRING","value":"o"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATEADD(DAY, \"s\".\"sequence\", \"mm\".\"min_datevalue\") <= \"mm\".\"max_datevalue\""},"2":{"slot":2,"type":"STRING","value":"s_Inner_mm"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"o\".\"datevalue\" = DATEADD(DAY, \"s\".\"sequence\", \"mm\".\"min_datevalue\")"},"2":{"slot":2,"type":"STRING","value":"s_Left_o"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s.sequence"},"2":{"slot":2,"type":"STRING","value":"sequence"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"mm.min_datevalue"},"2":{"slot":2,"type":"STRING","value":"start_date"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"o.datevalue"},"2":{"slot":2,"type":"STRING","value":"measurement_date"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"o.eur"},"2":{"slot":2,"type":"STRING","value":"EUR"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2674":{"id":2674,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1439414779,"x":483,"y":192,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[2703],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Spine"}}}},"visible":true},"2":{"slot":2,"name":"Starting Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"0"}}}},"visible":true},"3":{"slot":3,"name":"Increment Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"4":{"slot":4,"name":"End Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"5000"}}}},"visible":true},"5":{"slot":5,"name":"Output Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sequence"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2675":{"id":2675,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":739,"y":288,"width":32,"height":32,"inputConnectorIDs":[2687],"outputConnectorIDs":[2684],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATEADD(DAY, \"sequence\", \"start_date\")"},"2":{"slot":2,"type":"STRING","value":"densified_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"measurement_date\" IS NULL THEN NULL ELSE \"sequence\" END"},"2":{"slot":2,"type":"STRING","value":"gapseq"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2676":{"id":2676,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":355,"y":288,"width":32,"height":32,"inputConnectorIDs":[2706],"outputConnectorIDs":[2705,2707],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"String to Date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_DATE(\"Timestamp\", 'YYYY-MM-DD')"},"2":{"slot":2,"type":"STRING","value":"datevalue"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2677":{"id":2677,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1059,"y":208,"width":32,"height":32,"inputConnectorIDs":[2701],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Last Known"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_VALUE(\"EUR\" IGNORE NULLS) OVER (ORDER BY \"datevalue\" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"},"2":{"slot":2,"type":"STRING","value":"EUR_last_known"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2678":{"id":2678,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":899,"y":288,"width":32,"height":32,"inputConnectorIDs":[2684],"outputConnectorIDs":[2704,2685,2701,2702],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Renamer"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sequence"},"2":{"slot":2,"type":"STRING","value":"sequence"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"densified_date"},"2":{"slot":2,"type":"STRING","value":"datevalue"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"gapseq"},"2":{"slot":2,"type":"STRING","value":"gapseq"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"EUR"},"2":{"slot":2,"type":"STRING","value":"EUR"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2679":{"id":2679,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1059,"y":128,"width":32,"height":32,"inputConnectorIDs":[2702],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Zero Filled"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NVL(\"EUR\", 0)"},"2":{"slot":2,"type":"STRING","value":"EUR_zero_filled"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2680":{"id":2680,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":609793074,"x":1059,"y":288,"width":32,"height":32,"inputConnectorIDs":[2685],"outputConnectorIDs":[2686],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rolling Mean"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datevalue"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Lower Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"offset preceding"}}}},"visible":true},"6":{"slot":6,"name":"Upper Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"current row"}}}},"visible":true},"7":{"slot":7,"name":"Lower Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"3"}}}},"visible":true},"8":{"slot":8,"name":"Upper Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"3"}}}},"visible":false},"9":{"slot":9,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Average"},"2":{"slot":2,"type":"STRING","value":"EUR"},"3":{"slot":3,"type":"STRING","value":"EUR_rolling_mean"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2681":{"id":2681,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":1059,"y":448,"width":32,"height":32,"inputConnectorIDs":[2704],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Linear Backfill"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WITH data AS (\nSELECT \"sequence\", \"datevalue\", \"gapseq\", \"EUR\",\n       LAST_VALUE(\"gapseq\" IGNORE NULLS) OVER (ORDER BY \"datevalue\" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS prior_gapseq,\n       FIRST_VALUE(\"gapseq\" IGNORE NULLS) OVER (ORDER BY \"datevalue\" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS next_gapseq,\n       LAST_VALUE(\"EUR\" IGNORE NULLS) OVER (ORDER BY \"datevalue\" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS prior_EUR,\n       FIRST_VALUE(\"EUR\" IGNORE NULLS) OVER (ORDER BY \"datevalue\" ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS next_EUR\nFROM $T{Renamer})\nSELECT \"sequence\", \"datevalue\", \"gapseq\", \"EUR\",\n       CASE WHEN \"EUR\" IS NULL\n            THEN prior_EUR + ((next_EUR - prior_EUR) * (\"sequence\" - prior_gapseq) / (next_gapseq - prior_gapseq))\n            ELSE \"EUR\"\n       END AS \"EUR_linear_fill\"\nFROM data\nORDER BY \"sequence\" DESC"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2682":{"id":2682,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1171,"y":288,"width":32,"height":32,"inputConnectorIDs":[2686],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rolling Mean coalesced"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"COALESCE(\"EUR\", \"EUR_rolling_mean\")"},"2":{"slot":2,"type":"STRING","value":"EUR_rolling_mean_coalesced"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"},"2683":{"id":2683,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":480,"y":384,"width":32,"height":32,"inputConnectorIDs":[2707],"outputConnectorIDs":[2708],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MinMax"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"datevalue"},"2":{"slot":2,"type":"STRING","value":"Min"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"datevalue"},"2":{"slot":2,"type":"STRING","value":"Max"}}}},"visible":true}},"exportMappings":{},"activationStatus":"ENABLED"}},"connectors":{"2701":{"id":2701,"sourceID":2678,"targetID":2677},"2702":{"id":2702,"sourceID":2678,"targetID":2679},"2703":{"id":2703,"sourceID":2674,"targetID":2673},"2704":{"id":2704,"sourceID":2678,"targetID":2681},"2705":{"id":2705,"sourceID":2676,"targetID":2673},"2706":{"id":2706,"sourceID":2672,"targetID":2676},"2707":{"id":2707,"sourceID":2676,"targetID":2683},"2708":{"id":2708,"sourceID":2683,"targetID":2673},"2684":{"id":2684,"sourceID":2675,"targetID":2678},"2685":{"id":2685,"sourceID":2678,"targetID":2680},"2686":{"id":2686,"sourceID":2680,"targetID":2682},"2687":{"id":2687,"sourceID":2673,"targetID":2675}},"canUndo":true,"undoCommand":"Move Components","undoCreated":1641475588339,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"2671":{"id":2671,"x":1036,"y":354,"width":147,"height":40,"text":"Linear Regression is part of Amazon Redshift ML","colour":"00ce4f"},"3659":{"id":3659,"x":124,"y":187,"width":136,"height":55,"text":"Start with the columns of interest, flattened from the raw SUPER data","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"id":2670,"name":"example densification transformation","type":"TRANSFORMATION","tag":"9766177e-def8-45d3-9ac9-68e0a4ec7509"},"path":["matillion-examples","densification"]}],"version":"1.48.3","environment":"redshift"}